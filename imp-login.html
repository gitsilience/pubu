<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>用户登录</title>
    <script src="level0-js/jquery-2.1.1.js"></script>
    <link rel="stylesheet" href="CSS/gc-header.css">
    <link rel="stylesheet" href="CSS/imp-login-css.css">
</head>
<body>
<div class="global-container">
    <div class="gc-part-one-container">
        <div class="gc-top-container">
            <ul>
                <li class="gc-top-li position-1">
                    <span class="gc-top-cont-home row-top"></span>
                    <span class="gc-top-cont-desc">返回主页</span>
                </li>
                <li class="gc-top-li position-2">
                    <div class="usr-info">
                        <ul class="usr-info-salutation single">
                            <li class="usr-info-li wd-160">
                                <a href="imp-register.html">sign up</a>
                                or
                                <a href="imp-login.html">log in</a>
                            </li>
                            <li class="usr-info-li wd-70">
                                <a href="imp-login.html">
                                    <svg class="usr-info-icon" viewBox="-2765 2857 1080 1080">
                                        <path fill="#986844" d="M-1811.2 3598.5c-.1-4.3-.3-11.3-.8-20.3-.9-15.8-2.7-40.9-6.6-70.7-6.9-52.6-21.6-130.1-52.6-200.4-22.3-50.4-53.5-97.1-90.3-135.2-4.4-20.5-16.7-66.5-43.5-104.8l-5-7.2-54 35.5c-44.5-22.4-91-33.7-138.6-33.7-47.5 0-94.1 11.3-138.6 33.7l-54-35.5-5 7.2c-26.8 38.3-39 84.3-43.5 104.8-36.8 38.1-68 84.8-90.3 135.3-31.1 70.3-45.8 147.8-52.6 200.4-6.1 46.6-7.2 81.6-7.5 93.8 16.6 14 31.3 29.8 46.9 45 17.2 16.7 39.4 28.2 59.1 41.6 1.7 1.1 3.1 2.6 4.2 4.1 15.7 10.4 31 15.4 50.2 19.5 19.2 4.1 35.6 5.6 55.6 7.3 38.7 3.2 77 7.7 115.5 12.6 43.1 5.4 86.5 11.5 130 13.1 41.6 1.5 81.8-9 121.8-19.3 8.9-2.3 17.9-4.5 26.8-6.8.6-4.2 3-8.1 6.7-10.4 40.1-25 81.2-48.2 122-72 5.9-3.5 13.7-1.9 17.9 3.3 9-8.9 17.1-18.2 24.3-27.9l.2-.2.2-.2c1.7-2.6 1.8-2.7 1.5-12.6z"></path>
                                        <path fill="#FFF" d="M-1808.7 3494.8c-6.9-53.2-21.8-131.7-53.4-203.2-22.3-50.5-53.5-97.5-90.3-136.1-5.5-24.4-18.2-68.2-44.5-105.7l-10.6-15.1-57.3 37.7c-44.3-21.4-90.6-32.2-137.9-32.2-47.2 0-93.6 10.8-137.9 32.2l-57.3-37.7-10.6 15.1c-26.2 37.5-39 81.2-44.5 105.7-36.7 38.5-67.9 85.5-90.3 136.1-31.6 71.4-46.5 149.9-53.4 203.2-7.5 57.7-7.6 98-7.6 99.7v6.3l3.8 5.1c26 35 62.9 64.7 109.6 88.3 36.9 18.6 80 33.6 128.3 44.4 82.2 18.5 151.8 19 159.5 19h.6c7.7 0 77.3-.5 159.5-19 48.3-10.8 91.4-25.8 128.3-44.4 46.7-23.6 83.6-53.3 109.6-88.3l3.7-5v-6.3c.4-1.8.2-42.3-7.3-99.8zm-118.3 174.3c-34.8 17.6-75.8 31.8-121.8 42.1-80.7 18.1-150.4 18.3-153.4 18.3h-.6c-2.9 0-72.7-.2-153.4-18.3-46-10.3-87-24.5-121.8-42.1-41.7-21.1-74.7-47.2-98-77.6.4-22.5 5.1-167.5 58.6-288.5 21.8-49.3 52.4-94.9 88.5-131.8l1.8-1.9.5-2.6c2.7-13.1 12.9-56.4 36.3-93.4l37.2 24.5-7.3 16.6 22.8-11.9c43.3-22.6 88.7-34.1 135-34.1s91.7 11.5 135 34.1l22.8 11.9-7.3-16.6 37.2-24.5c23.4 37 33.6 80.4 36.3 93.4l.5 2.6 1.8 1.9c36.1 36.9 66.7 82.5 88.5 131.8 53.5 121 58.2 266.1 58.6 288.5-23.2 30.4-56.1 56.5-97.8 77.6zm-163-13c0 30.1-50.4 54.4-112.5 54.4s-112.5-24.4-112.5-54.4c0-30.1 50.4-54.4 112.5-54.4s112.5 24.3 112.5 54.4zm-223.5-65.3c0 12.3-10 22.3-22.3 22.3s-22.3-10-22.3-22.3 10-22.3 22.3-22.3c12.3-.1 22.3 9.9 22.3 22.3zm267.8 0c0 12.3-10 22.3-22.3 22.3s-22.3-10-22.3-22.3 10-22.3 22.3-22.3c12.3-.1 22.3 9.9 22.3 22.3z"></path>
                                    </svg>
                                </a>
                            </li>
                        </ul>
                    </div>
                </li>
            </ul>
        </div>
    </div>
    <div class="gc-register-container">
        <div class="gc-head-container">登录您的账户</div>
        <form action="imp-index.html" method="get">
            <div class="gc-form-container">
                <div class="gc-reg-ipt-container">
                    <ul>
                        <li class="con-register-column">
                            <span class="reg-tip tip-position-1">账户：</span><input type="text" id="txt_id" name="usr_id" placeholder="name@example.com" />
                        </li>
                        <li class="con-register-column">
                            <span class="reg-tip tip-position-2">密码：</span><input type="password" id="txt_pass" name="usr_pass" placeholder="密码" />
                        </li>
                        <li class="con-register-column">
                            <input type="checkbox" id="remember_pass" value="rememberpass" /><label for="remember_pass" class="remember-pass">记住密码</label>
                        </li>
                    </ul>
                </div>
                <div class="gc-reg-check-container">
                    <ul>
                        <li class="gc-check-column" id="check-column-1">
                            <label class="con-register-lab" id="error_id"></label>
                            <label class="con-reg-right" id="check_right_id"></label>
                        </li>
                        <li class="gc-check-column" id="check-column-2">
                            <label class="con-register-lab" id="error_pass"></label>
                            <label class="con-reg-right" id="check_right_passwd"></label>
                        </li>
                    </ul>
                </div>
            </div>
            <div class="gc-reg-confirm">
                <input type="submit" id="btn_join" value="登录" />
            </div>
        </form>
    </div>
    <footer class="gc-part-three-container">
        <div class="gc-ft-cont-1">AS SEEN ON</div>
        <!--<div class="gc-ft-cont-2">
            <ul>
                <li class="gc-ft-list-sty">
                    <a href="http://www.jb51.net/w3school/">W3School</a></li>
                <li class="gc-ft-list-sty"><a href="http://v3.bootcss.com/">Bootstrap</a></li>
                <li class="gc-ft-list-sty">
                    <a href="http://v3.bootcss.com/">NodeJs</a></li>
            </ul>
        </div>-->
        <div class="gc-ft-cont-3">
            <div class="gc-ft-cont3-bd">
                Copyright &copy; 2016   <span class="ft-cont3-author">Built by: @blueEvE</span>
            </div>
        </div>
    </footer>
</div>
<script>
    function auto_logoin(contxt_id){
        var usrs=[];
        //数组，每个元素都是一个json对象，用来存储所有注册成功的帐号和密码！！
        if(localStorage.getItem('usrarr')){
            usrs = JSON.parse(localStorage.getItem('usrarr') || []);
        }
        for (var index in usrs) {
            if (contxt_id == usrs[index].usr_id) {
               if(usrs[index].chk_remember_pass == 'true'){
//                   console.log("获取的密码："+contxt_pass);
                   return usrs[index].usr_passwd;
               }
            }
        }
        return null;
    }
    function match_id(content){
        var usrs=[];
        //数组，每个元素都是一个json对象，用来存储所有注册成功的帐号和密码！！
        if(localStorage.getItem('usrarr')){
            usrs = JSON.parse(localStorage.getItem('usrarr') || []);
        }
        for (var index in usrs) {
//            console.log(usrs[index]);
            if (content == usrs[index].usr_id) {
                return true;
            }
        }
        return false;
    }
    function match_pass(ipt_id,content){
        var usrs=[];
        //数组，每个元素都是一个json对象，用来存储所有注册成功的帐号和密码！！
        if(localStorage.getItem('usrarr')){
            usrs = JSON.parse(localStorage.getItem('usrarr') || []);
        }
        for (var index in usrs) {
            if (ipt_id == usrs[index].usr_id) {
               if(content == usrs[index].usr_passwd)
                   return true;
            }
        }
        return false;
    }
    function check_id(content){
        var txt_pass;
        if(content.length<6){
            $("#error_id").html("账号必须大于6位").css({display:"block"});
            $("#check_right_id").css("display","none");
            return false;
        }else if(!/^[A-Za-z]\w{5,19}$/.test(content)){
            $("#error_id").html("账户以字母开头，长度6-20,包括字母，下划线和数字").
            css({display:"block",color:"red",border:"solid 1px #999797"});
            $("#check_right_id").css("display","none");
            return false;
        }else if(!match_id(content)){
            $("#error_id").html("该账户不存在").
            css({display:"block",color:"red",border:"solid 1px #999797"});
            $("#check_right_id").css("display","none");
        }else{
                $("#error_id").html("").css({display:"none"});
                $("#check_right_id").css("display","block");
                if(auto_logoin(content)!=null) {
                    console.log("自动填入的密码："+auto_logoin(content));
                    $("#txt_pass").val(auto_logoin(content));
                    $("#remember_pass").prop('checked',true);
                }
                return true;
        }
    }

    function check_pass(contxtid,contxtpass){
        if(!match_pass(contxtid,contxtpass)){
            $("#error_pass").html("密码不正确").
            css({display:"block",border:"solid 2px #34b8b5"});
            $("#check_right_passwd").css("display","none");
            return false;
        } else{
                $("#error_pass").css("display","none");
                $("#check_right_passwd").css({display:"block"});
                return true;
        }
    }
    $(function(){
        $(".position-1").mouseover(function(){
            $(this).css("cursor","pointer");
            $(".gc-top-cont-home").css({background:"url('img-mainpage/home-hover.png') no-repeat center"});
            $(".gc-top-cont-desc").css({color:" #a1a1a1"});
        }).mouseout(function(){
            $(".gc-top-cont-home").css({background:"url('img-mainpage/home.png') no-repeat center"});
            $(".gc-top-cont-desc").css({color:" #fff"});
        });
        $(".position-1").click(function(){
            location.href="imp-index.html";
        });
        $("#txt_id").blur(function(){
            var content=$(this).val().trim();
            check_id(content);
        });
        $("#txt_pass").blur(function(){
            var contxt_id=$("#txt_id").val().trim();
            var contxt_pass=$(this).val().trim();
            check_pass(contxt_id,contxt_pass);
        });

        $("form").submit(function(){
            var usr_id=$("#txt_id");
            var usr_passwd=$("#txt_pass");
            var chk_remember=$("#remember_pass");
            if(check_id(usr_id.val().trim())&&check_pass(usr_id.val().trim(),usr_passwd.val().trim())){
//                alert(chk_remember.prop('checked'));
//                用来自动填入密码！！
                if(chk_remember.prop('checked')){
//                    alert("1: ");
                    var users=[];
                    if(localStorage.getItem('usrarr')){
                        users = JSON.parse(localStorage.getItem('usrarr') || []);
                    }
                    for (var index in users) {
                        if (usr_id.val().trim() == users[index].usr_id && usr_passwd.val().trim() == users[index].usr_passwd ) {
                            users[index].chk_remember_pass='true';
                            localStorage.setItem('usrarr',JSON.stringify(users));
//                            alert("2: ");
                        }
                    }
//                    alert("3: ");
                }
                sessionStorage.setItem('isLogin','true');
                sessionStorage.setItem('usr_id',usr_id.val().trim());
//                sessionStorage.setItem('usr_passwd',usr_passwd.val().trim());
                sessionStorage.setItem('url','imp-login.html');
                return true;
            }
            return false;
        });

        $(".gc-ft-list-sty").mouseover(function(){
            $(this).css({background:'#178d88',cursor:'pointer'});
        }).mouseout(function(){
            $(this).css({background:' #0e5653'});
        });
    });
</script>
</body>
</html>